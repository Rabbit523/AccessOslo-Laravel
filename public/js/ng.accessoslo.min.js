'use strict';
var application = angular.module('accessosloApp.application', []);
var admin = angular.module('accessosloApp.admin', []);
var member = angular.module('accessosloApp.member', [])
var accessosloApp = angular.module('accessosloApp', ['accessosloApp.application', 'accessosloApp.admin', 'accessosloApp.member']);

application.factory('apiRequest', [function () {
  var instance = {};
  instance.ajax = function (type, endpoint, data, onSuccess, onError) {
    $.ajax({
      type: type,
      url: config.server + endpoint,
      data: data,
      beforeSend: function (request) {
        request.setRequestHeader("X-CSRF-TOKEN", config.token);
      },
      success: function (response) {
        if (response.success) {
          onSuccess(response.data);
        } else {
          onError(response.error);
        }
      },
      error: onError
    });
  };
  return instance;
}]);
application.factory("usersAPI", ['apiRequest', function (apiRequest) {
  var extended = {};
  var endpoint = "users";

  extended.register = function (user, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/register", user, onSuccess, onError);
  };

  extended.saveProfile = function (user, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/save-profile", user, onSuccess, onError);
  };

  extended.changePassword = function (user, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/change-password", user, onSuccess, onError);
  };

  extended.getProfileImageUploadURL = function(){
    return config.server + endpoint + "/get-profile-image";
  };
  extended.getCustomer = function (data, onSuccess, onError) {
    apiRequest.ajax("POST", endpoint + "/get-customer", data, onSuccess, onError);
  };

  extended.getPassengers = function (user, onSuccess, onError) {
    apiRequest.ajax("POST", endpoint + "/get-passengers", user, onSuccess, onError);
  };

  extended.deletePassenger = function (passenger, onSuccess, onError) {
    apiRequest.ajax("POST", endpoint + "/delete-passenger", passenger, onSuccess, onError);
  };

  extended.add_profile = function (data, onSuccess, onError) {
    apiRequest.ajax("POST", endpoint + "/add-profile", data, onSuccess, onError);
  };

  extended.update_profile = function (data, onSuccess, onError) {
    apiRequest.ajax("POST", endpoint + "/update-profile", data, onSuccess, onError);
  };

  return extended;
}]);
application.factory("servicesAPI", ['apiRequest', function (apiRequest) {
  var extended = {};
  var endpoint = "services";

  extended.getAllLimousine = function (onSuccess, onError) {    
    apiRequest.ajax("GET", endpoint + "/get-limousines", {}, onSuccess, onError);
  };
  
  extended.meet_booking = function (data, onSuccess, onError) {
    apiRequest.ajax("POST", endpoint + "/meet-booking", data, onSuccess, onError)
  };

  extended.limousine_booking = function (data, onSuccess, onError) {
    apiRequest.ajax("POST", endpoint + "/limousine-booking", data, onSuccess, onError)
  };

  extended.getAllMeets = function (onSuccess, onError) {
    apiRequest.ajax("GET", endpoint + "/get-allMeets", {}, onSuccess, onError)
  };

  extended.booking_travels = function (data, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/booking-travels", data, onSuccess, onError);
  };

  extended.getAllTravels = function (type, onSuccess, onError) {    
    apiRequest.ajax("GET", endpoint + "/get-allTravels/" + type, {}, onSuccess, onError);
  };

  extended.request = function (data, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/handling-request", data, onSuccess, onError);
  };

  extended.getAllRequests = function (onSuccess, onError) {    
    apiRequest.ajax("GET", endpoint + "/get-handling-request", {}, onSuccess, onError);
  };

  extended.getAllPassengers = function (onSuccess, onError) {    
    apiRequest.ajax("GET", endpoint + "/get-all-passengers", {}, onSuccess, onError);
  };

  return extended;
}]);
application.factory("chartersAPI", ['apiRequest', function (apiRequest) {
  var extended = {};
  var endpoint = "charters";

  extended.create = function (flight, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/create", flight, onSuccess, onError);
  };
 
  extended.getDashboard = function (onSuccess, onError) {    
    apiRequest.ajax("GET", endpoint + "/get-admindashboard", {}, onSuccess, onError);
  };

  extended.cargo_booking = function (flight, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/cargo-booking", flight, onSuccess, onError);
  };
  
  extended.searchDashboard = function (data, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/searchdashboard", data, onSuccess, onError);
  };

  extended.getMemberNotice = function (data, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/get-notice", data, onSuccess, onError);
  };

  return extended;
}]);
application.factory("storesAPI", ['apiRequest', function (apiRequest) {
  var extended = {};
  var endpoint = "stores";

  extended.getBannerImageUploadURL = function(){
    return config.server + endpoint + "/get-banner-image";
  };
  extended.getPageImageUploadURL = function(){
    return config.server + endpoint + "/get-page-image";
  };
  extended.getPostImageUploadURL = function(){
    return config.server + endpoint + "/get-post-image";
  };
  extended.SavePosts = function (data, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/save-post", data, onSuccess, onError);
  };
  extended.UpdatePosts = function (data, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/update-post", data, onSuccess, onError);
  };
  extended.PublishPosts = function (data, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/publish-post", data, onSuccess, onError);
  };
  extended.CreatePage = function (data, onSuccess, onError) {
    apiRequest.ajax("POST", endpoint + "/create-page", data, onSuccess, onError);
  };
  extended.SavePage = function (data, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/save-page", data, onSuccess, onError);
  };
  extended.PublishPage = function (data, onSuccess, onError) {    
    apiRequest.ajax("POST", endpoint + "/publish-page", data, onSuccess, onError);
  };
  return extended;
}]);
'use strict';
application.factory('accessosloAPI', ['usersAPI', 'servicesAPI', 'chartersAPI', 'storesAPI', function (usersAPI, servicesAPI, chartersAPI, storesAPI) {
  var instance = {};
  instance.users = usersAPI;
  instance.services = servicesAPI;
  instance.charters = chartersAPI;
  instance.stores = storesAPI;
  return instance;
}]);

'use strict';
admin.directive('accessosloDashboard', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/admin/dashboard/view.html',
    scope: {},
    controller: function ($scope) {
      $scope.user = {};
      $scope.counts = {};
      $scope.data_change = false;
      $scope.executiveView = function () {       
        if ($scope.data_change) {
            var startDate= $("#datepicker").val().split('-')[0];
            var endDate= $("#datepicker").val().split('-')[1];           
          setTimeout(function () { window.location.href= "/admin/executive-search-charter?startDate="+startDate+"&endDate="+endDate}, 100);    
        } else {
          setTimeout(function () { window.location.href= "/admin/executive-charter"}, 100);    
        }
      };
      $scope.groupView = function () {       
        if ($scope.data_change) {
            var startDate= $("#datepicker").val().split('-')[0];
            var endDate= $("#datepicker").val().split('-')[1];           
          setTimeout(function () { window.location.href= "/admin/group-search-charter?startDate="+startDate+"&endDate="+endDate}, 100);    
        } else {
          setTimeout(function () { window.location.href= "/admin/group-charter"}, 100);    
        }
      };
      $scope.helicopterView = function () {       
        if ($scope.data_change) {
            var startDate= $("#datepicker").val().split('-')[0];
            var endDate= $("#datepicker").val().split('-')[1];           
          setTimeout(function () { window.location.href= "/admin/helicopter-search-charter?startDate="+startDate+"&endDate="+endDate}, 100);    
        } else {
          setTimeout(function () { window.location.href= "/admin/helicopter-charter"}, 100);    
        }
      };
      $scope.cargoView = function () {       
        if ($scope.data_change) {
            var startDate= $("#datepicker").val().split('-')[0];
            var endDate= $("#datepicker").val().split('-')[1];           
          setTimeout(function () { window.location.href= "/admin/cargo-search-charter?startDate="+startDate+"&endDate="+endDate}, 100);    
        } else {
          setTimeout(function () { window.location.href= "/admin/cargo-charter"}, 100);    
        }
      };
      $scope.meetView = function () {       
        if ($scope.data_change) {
            var startDate= $("#datepicker").val().split('-')[0];
            var endDate= $("#datepicker").val().split('-')[1];           
          setTimeout(function () { window.location.href= "/admin/meet-search-charter?startDate="+startDate+"&endDate="+endDate}, 100);    
        } else {
          setTimeout(function () { window.location.href= "/admin/meet-greet"}, 100);    
        }
      };
      $scope.limousineView = function () {       
        if ($scope.data_change) {
            var startDate= $("#datepicker").val().split('-')[0];
            var endDate= $("#datepicker").val().split('-')[1];           
          setTimeout(function () { window.location.href= "/admin/meet-search-charter?startDate="+startDate+"&endDate="+endDate}, 100);    
        } else {
          setTimeout(function () { window.location.href= "/admin/airport-limousine"}, 100);    
        }
      };
      $scope.handlingView = function () {       
        if ($scope.data_change) {
            var startDate= $("#datepicker").val().split('-')[0];
            var endDate= $("#datepicker").val().split('-')[1];           
          setTimeout(function () { window.location.href= "/admin/handling-requests-search?startDate="+startDate+"&endDate="+endDate}, 100);    
        } else {
          setTimeout(function () { window.location.href= "/admin/handling-requests"}, 100);    
        }
      };
      $scope.passengerView = function () {       
        if ($scope.data_change) {
            var startDate= $("#datepicker").val().split('-')[0];
            var endDate= $("#datepicker").val().split('-')[1];           
          setTimeout(function () { window.location.href= "/admin/air-search-passenger?startDate="+startDate+"&endDate="+endDate}, 100);    
        } else {
          setTimeout(function () { window.location.href= "/admin/air-passenger"}, 100);    
        }
      };
      $scope.privateView = function () {       
        if ($scope.data_change) {
            var startDate= $("#datepicker").val().split('-')[0];
            var endDate= $("#datepicker").val().split('-')[1];           
          setTimeout(function () { window.location.href= "/admin/private-search-travel?startDate="+startDate+"&endDate="+endDate}, 100);    
        } else {
          setTimeout(function () { window.location.href= "/admin/private-travel"}, 100);    
        }
      };
      $scope.eventView = function () {       
        if ($scope.data_change) {
            var startDate= $("#datepicker").val().split('-')[0];
            var endDate= $("#datepicker").val().split('-')[1];           
          setTimeout(function () { window.location.href= "/admin/group-search-travel?startDate="+startDate+"&endDate="+endDate}, 100);    
        } else {
          setTimeout(function () { window.location.href= "/admin/group-travel"}, 100);    
        }
      };
      var init = function () {
        $scope.user = user;
        accessosloAPI.charters.getDashboard(function (response) {
          console.log(response);
          $scope.counts = {executive_count: response.executive, group_count: response.group, helicopter_count: response.helicopter, cargo_count: response.cargo, limousine_count: response.limousine, handling_count: response.handling, airpassenger_count: response.airpassenger, private_count: response.private, event_count: response.event, meet_count: response.meet, emptyleg_count: response.emptyleg};
          $scope.badges = {executive_badge: response.executive_badge, group_badge: response.group_badge, helicopter_badge: response.helicopter_badge, cargo_badge: response.cargo_badge, meet_badge: response.meet_badge, limousine_badge: response.limousine_badge, handling_badge: response.handling_badge, passenger_badge: response.passenger_badge, private_badge: response.private_badge, event_badge: response.event_badge, emptyleg_badge: response.emptyleg_badge};
          $scope.$apply();    
          if ($scope.badges.executive_badge != 0) {
            $(".executive_badge").attr('style', "display:inline;");
            $(".executive_badge").html($scope.badges.executive_badge);
          }
          if ($scope.badges.group_badge != 0) {
            $(".group_badge").attr('style', "display:inline;");
            $(".group_badge").html($scope.badges.group_badge);
          }
          if ($scope.badges.helicopter_badge != 0) {
            $(".helicopter_badge").attr('style', "display:inline;");
            $(".helicopter_badge").html($scope.badges.helicopter_badge);
          }
          if ($scope.badges.cargo_badge != 0) {
            $(".cargo_badge").attr('style', "display:inline;");
            $(".cargo_badge").html($scope.badges.cargo_badge);
          }
          if ($scope.badges.meet_badge != 0) {
            $(".meet_badge").attr('style', "display:inline;");
            $(".meet_badge").html($scope.badges.meet_badge);
          }
          if ($scope.badges.limousine_badge != 0) {
            $(".limousine_badge").attr('style', "display:inline;");
            $(".limousine_badge").html($scope.badges.limousine_badge);
          }
          if ($scope.badges.handling_badge != 0) {
            $(".handling_badge").attr('style', "display:inline;");
            $(".handling_badge").html($scope.badges.handling_badge);
          }
          if ($scope.badges.passenger_badge != 0) {
            $(".passenger_badge").attr('style', "display:inline;");
            $(".passenger_badge").html($scope.badges.passenger_badge);
          }
          if ($scope.badges.event_badge != 0) {
            $(".event_badge").attr('style', "display:inline;");
            $(".event_badge").html($scope.badges.event_badge);
          }         
          if ($scope.badges.emptyleg_badge != 0) {         
            $(".emptyleg_badge").attr('style', "display:inline;");
            $(".emptyleg_badge").html($scope.badges.emptyleg_badge);
          }    
        });
        $("#datepicker").daterangepicker({});
        $('input[name="datepicker"]').on('apply.daterangepicker', function(ev, picker) {
          $scope.data_change = true;
          var data = {
            startDate: $("#datepicker").val().split('-')[0],
            endDate: $("#datepicker").val().split('-')[1]
          };          
          accessosloAPI.charters.searchDashboard(data, function (response) {
            $scope.counts = {executive_count: response.executive, group_count: response.group, helicopter_count: response.helicopter, cargo_count: response.cargo, limousine_count: response.limousine, handling_count: response.handling, airpassenger_count: response.airpassenger, private_count: response.private, event_count: response.event, meet_count: response.meet, emptyleg_count: response.emptyleg}
            $scope.$apply();    
          });
        });
      };

      init();
    }
  };  
}]);

'use strict';
admin.directive('accessosloPost', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/admin/single-post/view.html',
    scope: {},
    controller: function ($scope) {
      $scope.user = {};
      $scope.postData = {};
      $scope.type = "";
      $scope.is_img = false;      
      var type = $(".page-container").data('type');
      var get_post = $(".page-container").data("source");
      $scope.Save = function () {
        var data = {
          id: $scope.postData.id,
          post_title: $scope.postData.post_title,
          post_description: $("#post_description").val(),
          meta_title: $scope.postData.meta_title,
          meta_description: $("#meta_description").val(),
          status: "saved",
          author: user.first_name + " " + user.last_name,
          published_date: "saved"
        };
        if (type == "edit") {data.id = get_post.id;};
        accessosloAPI.stores.UpdatePosts(data, function (response) {
          setTimeout(function () { window.location.href= "/admin/posts"}, 100);         
        }); 
      };
      $scope.Publish = function () {
        var data = {};
        if (type == "new") {
          data = {id: $scope.postData.id, status: "published"};
        } else {
          data = {id: get_post.id, status: "published"};
        }
        accessosloAPI.stores.PublishPosts(data, function (response) { 
          setTimeout(function () { window.location.href= "/admin/posts"}, 100);         
        }); 
      };
      $("#post-title").on('click', function(e) {        
        $scope.type = "PostImage";
        $scope.$apply();
        if (type == "new") {setTimeout(initDropZone, 100);}  
      });
      $("#meta-title").on('click', function(e) {
        $(".section_post").show();
        $(".section_single").show();
        $scope.type = "SingleImage";
        var data = {
          post_title: $scope.postData.post_title,
          post_description: $("#post_description").val()
        };
        if (type == "new") {
          accessosloAPI.stores.SavePosts(data, function (response) {
            $scope.postData.id = response.id;             
          });  
        }
        $scope.$apply();
        if (type == "new") {setTimeout(initDropZone, 100);}   
      });
      var onImageUploadSuccess = function (file, response) {};
      var onSendingImage = function (file, xhr, formData) { 
        if (type == "new") {
          if ($scope.type == "PostImage") {
            formData.append("id", $scope.postData.id);
          } else if ($scope.type == "SingleImage") {
            formData.append("id", $scope.postData.id);
          }
        } else {
          formData.append("id", get_post.id);
        }                 
      };
      var initDropZone = function () {
        var dropzone;
        if (type == "new") {
          if ($scope.type == "PostImage") {
            dropzone= new Dropzone("#post-image", {
              url: accessosloAPI.stores.getPageImageUploadURL(),
              acceptedFiles: 'image/png, image/jpeg'
            });
          } else if ($scope.type == "SingleImage") {
            dropzone= new Dropzone("#single-image", {
              url: accessosloAPI.stores.getPostImageUploadURL(),
              acceptedFiles: 'image/png, image/jpeg'
            });
          }
          dropzone.on("sending", onSendingImage);
          dropzone.on("success", onImageUploadSuccess);
        } else {
          dropzone= new Dropzone("#post-image", {
            url: accessosloAPI.stores.getPageImageUploadURL(),
            acceptedFiles: 'image/png, image/jpeg'
          });
          dropzone.on("sending", onSendingImage);
          dropzone.on("success", onImageUploadSuccess);
          dropzone= new Dropzone("#single-image", {
            url: accessosloAPI.stores.getPostImageUploadURL(),
            acceptedFiles: 'image/png, image/jpeg'
          });
          dropzone.on("sending", onSendingImage);
          dropzone.on("success", onImageUploadSuccess);
        }         
      };
      var init = function () {    
        if (user.img) {$scope.is_img = true;}   
        if (type == "new") {
          $(".post_title").html("New Post");
          $(".section_post").hide();
          $(".section_single").hide();       
        } else {
          $(".post_title").html("Edit Post");
          setTimeout(initDropZone, 100); 
        }
        $scope.user = user;    
        $scope.postData.post_title = get_post.post_title;      
        $("#post_description").val(get_post.post_description);        
        $("#meta_description").val(get_post.meta_description);
        $scope.postData.meta_title = get_post.meta_title;
      };      
      init();
    }
  };

}]);

'use strict';
admin.directive('accessosloPage', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/admin/single-page/view.html',
    scope: {},
    controller: function ($scope) {     
      $scope.pageData = {};
      $scope.is_upload = false;
      $scope.is_img = false;
      $scope.is_new = false;
      $scope.page_newid = "";
      var page = $(".page-container").data("source");

      $scope.Save = function () {         
        if ($scope.is_new) {
          $scope.pageData.id = $scope.page_newid;
        } else {
          $scope.pageData.id = page.id;
        }        
        $scope.pageData.author = user.first_name + " " + user.last_name;
        var page_title = $("#page_title").summernote('code');
        var meta_title = $("#meta_title").summernote('code');
        $scope.pageData.page_title = page_title;
        $scope.pageData.page_title_plain = $(page_title).text();
        $scope.pageData.page_content = $("#page_content").summernote('code'); 
        $scope.pageData.extra_content = $("#page_content1").summernote('code');
        $scope.pageData.meta_title = $("#meta_title").summernote('code');
        $scope.pageData.meta_description = $("#meta_description").summernote('code'); 
       
        accessosloAPI.stores.SavePage($scope.pageData, function (response) {          
          setTimeout(function () { window.location.href= "/admin/pages"}, 100);            
        });  
      };
      $scope.Publish = function () {  
        $scope.pageData.author = user.first_name + " " + user.last_name;
        if ($scope.is_new) {
          $scope.pageData.id = $scope.page_newid;
        } else {
          $scope.pageData.id = page.id;
        }
        var page_title = $("#page_title").summernote('code');
        $scope.pageData.page_title = page_title;
        $scope.pageData.page_title_plain = $(page_title).text();
        $scope.pageData.page_content = $("#page_content").summernote('code'); 
        $scope.pageData.extra_content = $("#page_content1").summernote('code');
        $scope.pageData.meta_title = $(meta_title).text();
        $scope.pageData.meta_description = $("#meta_description").summernote('code');          
        accessosloAPI.stores.PublishPage($scope.pageData, function (response) {         
          setTimeout(function () { window.location.href= "/admin/pages"}, 100);                    
        });  
      };
      var onImageUploadSuccess = function (file, response) {        
        if (response.success) {
            $scope.pageData.banner_img = response.data;
            $scope.$apply();
        }
      };
      var onSendingImage = function (file, xhr, formData) {     
        if ($scope.is_new) {
          formData.append("id", $scope.page_newid);
        } else {
          formData.append("id", page.id);
        }        
      };
      var initDropZone = function () {
        var dropzone = new Dropzone("#image-uploader", {
            url: accessosloAPI.stores.getBannerImageUploadURL(),
            acceptedFiles: 'image/png, image/jpeg'
        });
        dropzone.on("sending", onSendingImage);
        dropzone.on("success", onImageUploadSuccess);
      };
      $('#meta_title').on('summernote.blur', function(we, contents, $editable) {      
          if ($scope.is_new) {
            var page_title = $("#page_title").summernote('code');
            var meta_title = $("#meta_title").summernote('code');
            var data = {
              author: user.first_name + " " + user.last_name,
              page_title: $("#page_title").summernote('code'),
              page_title_plain: $(page_title).text(),
              page_content: $("#page_content").summernote('code'),
              extra_content: $("#page_content1").summernote('code'),          
              meta_title: $(meta_title).text(),       
              meta_description: "new"
            };                
            accessosloAPI.stores.CreatePage(data, function (response) {             
              $scope.page_newid = response;
              $scope.$apply();
            });
          }
      });
      var init = function () {       
        if (user.img) {
          $scope.is_img = true;
        }
        setTimeout(initDropZone, 100);    
        $scope.user = user;            
        if (page.id == 2 || page.id == 3 || page.id == 6 || page.id == 8 || page.id == 14 || page.id == 15 || page.id == 16) {
          $("#extra_content").attr('style', 'display: block;');
        }       
        $("#page_title").summernote({height: 100});
        $("#page_content").summernote({height: 200});
        $("#page_content1").summernote({height: 200});
        $("#meta_title").summernote({height: 50});
        $("#meta_description").summernote({height: 150});
        $("#page_title").summernote('code', page.page_title);
        $("#page_content").summernote('code', page.page_content);
        $("#page_content1").summernote('code', page.extra_content);
        $("#meta_title").summernote('code', page.meta_title);
        $("#meta_description").summernote('code', page.meta_description);
        if (!page.id) {
          $scope.is_new = true;
        }        
      };
      init();
    }
  };  
}]);

'use strict';
admin.directive('accessosloSettings', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/admin/setting/view.html',
    scope: {},
    controller: function ($scope) {     
      $scope.password_success = false; $scope.password_unsuccess = false; $scope.profile_success = false;
      $scope.is_img = false;
      $scope.imageUpload = false;
      $scope.user_data = {profile_img: ""};
      var onImageUploadSuccess = function (file, response) {        
        if (response.success) {
            $scope.user_data.profile_img = response.data;
            $scope.is_img = true;
            $scope.$apply();
        }
      };
      var onSendingImage = function (file, xhr, formData) {      
        formData.append("id", user.id);
      };
      var initDropZone = function () {
        var dropzone = new Dropzone("#image-uploader", {
            url: accessosloAPI.users.getProfileImageUploadURL(),
            acceptedFiles: 'image/png, image/jpeg'
        });
        dropzone.on("sending", onSendingImage);
        dropzone.on("success", onImageUploadSuccess);
      };
      $scope.UploadImage = function () {
        $scope.imageUpload = true;
        setTimeout(initDropZone, 100); 
      };
      $scope.OnSave = function () {
        if($("#personal_form").valid()) {
          if ($("#phone").intlTelInput('isValidNumber')) {
            var full_name = $("#full_name").val();
            var data = {
              id: user.id,
              first_name: full_name.split(' ')[0],
              last_name: full_name.split(' ')[1],
              phone: $("#phone").intlTelInput('getNumber'),
              email: $("#email").val()
            };            
            accessosloAPI.users.saveProfile(data, function (response) {
              $scope.profile_success = true;
              $scope.$apply();
            }); 
          }
        } 
        if($("#password_form").valid()) {
          if ($("#new_password").val() == $("#confirm_password").val()) {
            var data = {
              user_id: user.id,
              old_password: $("#old_password").val(),
              new_password: $("#new_password").val()
            };
            accessosloAPI.users.changePassword(data, function (response) {  
              if (response.success == "success") {
                $scope.password_success = true;
                $scope.password_unsuccess = false;
                $scope.$apply();
              } else if (response.success == "error"){
                $scope.password_success = false;
                $scope.password_unsuccess = true;
                $scope.$apply();
              }
            });            
          } else {
            alert("skriv nytt passord igjen.");
          }
        }
        
      };
      var init = function () {     
        if (user.img) {
          $("#full_name").val(user.first_name + " " + user.last_name);
          $("#phone").val(user.phone);
          $("#email").val(user.email);
          $scope.user_data.profile_img = user.img;
          $scope.is_img = true;
        }
        $("#phone").intlTelInput({
          allowDropdown: true,
          autoHideDialCode: false,
          autoPlaceholder: "polite",
          dropdownContainer: "body",
          preferredCountries: ['no', 'se', 'gb', 'de', 'us'],
          utilsScript: "/js/vendor/utils.js"
        });
        $("#personal_form").validate({
          errorPlacement: function () { },
            errorClass: "label",
            highlight: function (element, errorClass, validClass) {
                $(element).parent().addClass("error");
                $(element).parent().removeClass("success");
            },
            unhighlight: function (element, errorClass, validClass) {
                $(element).parent().removeClass("error");
                $(element).parent().addClass("success");
            }
        });
        $("#password_form").validate({
          errorPlacement: function () { },
            errorClass: "label",
            highlight: function (element, errorClass, validClass) {
                $(element).parent().addClass("error");
                $(element).parent().removeClass("success");
            },
            unhighlight: function (element, errorClass, validClass) {
                $(element).parent().removeClass("error");
                $(element).parent().addClass("success");
            }
        });
        accessosloAPI.charters.getDashboard(function (response) {
          $scope.counts = {executive_count: response.executive, group_count: response.group, helicopter_count: response.helicopter, cargo_count: response.cargo, limousine_count: response.limousine, handling_count: response.handling, airpassenger_count: response.airpassenger, private_count: response.private, event_count: response.event, meet_count: response.meet};
          $scope.badges = {executive_badge: response.executive_badge, group_badge: response.group_badge, helicopter_badge: response.helicopter_badge, cargo_badge: response.cargo_badge, meet_badge: response.meet_badge, limousine_badge: response.limousine_badge, handling_badge: response.handling_badge, passenger_badge: response.passenger_badge, private_badge: response.private_badge, event_badge: response.event_badge};
          $scope.$apply();    
          if ($scope.badges.executive_badge != 0) {
            $(".executive_badge").attr('style', "display:inline;");
            $(".executive_badge").html($scope.badges.executive_badge);
          }
          if ($scope.badges.group_badge != 0) {
            $(".group_badge").attr('style', "display:inline;");
            $(".group_badge").html($scope.badges.group_badge);
          }
          if ($scope.badges.helicopter_badge != 0) {
            $(".helicopter_badge").attr('style', "display:inline;");
            $(".helicopter_badge").html($scope.badges.helicopter_badge);
          }
          if ($scope.badges.cargo_badge != 0) {
            $(".cargo_badge").attr('style', "display:inline;");
            $(".cargo_badge").html($scope.badges.cargo_badge);
          }
          if ($scope.badges.meet_badge != 0) {
            $(".meet_badge").attr('style', "display:inline;");
            $(".meet_badge").html($scope.badges.meet_badge);
          }
          if ($scope.badges.limousine_badge != 0) {
            $(".limousine_badge").attr('style', "display:inline;");
            $(".limousine_badge").html($scope.badges.limousine_badge);
          }
          if ($scope.badges.handling_badge != 0) {
            $(".handling_badge").attr('style', "display:inline;");
            $(".handling_badge").html($scope.badges.handling_badge);
          }
          if ($scope.badges.passenger_badge != 0) {
            $(".passenger_badge").attr('style', "display:inline;");
            $(".passenger_badge").html($scope.badges.passenger_badge);
          }
          if ($scope.badges.event_badge != 0) {
            $(".event_badge").attr('style', "display:inline;");
            $(".event_badge").html($scope.badges.event_badge);
          }
        });
      };
      init();
    }
  };  
}]);

'user strict';
member.directive('accessosloMemberPrivatetravel', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/member/make_request/private-travel.html',
    scope: {},
    controller: function ($scope) {
      $scope.travelData = {};
      $scope.OnSend = function () {  
        if ($("#private_form").valid()) {
          if($("#private_phone").intlTelInput("isValidNumber")) {
            $scope.travelData.travel_type="private";
            $scope.travelData.phone= $("#private_phone").intlTelInput("getNumber");
            accessosloAPI.services.booking_travels($scope.travelData, function (response) {
              var loading = new Loading({ title: 'Please check your email.', discription: 'Loading...' });              
              setTimeout(function () { window.location.href= response.redirect;}, 0);               
            });     
          }           
        } else {
          alert("You must fill in all fields.");
        }    
      };

      var init = function () {
        $(".dashboard_btn").attr('style', 'display: inline-block; float:right; margin-right:10px; margin-top:8px;');
        $("#private_phone").intlTelInput({
          allowDropdown: true,
          autoHideDialCode: false,
          autoPlaceholder: "polite",
          dropdownContainer: "body",
          preferredCountries: ['no', 'se', 'gb', 'de', 'us'],
          utilsScript: "/js/vendor/utils.js"
        });
        $("#private_form").validate({
          errorPlacement: function () { },
          errorClass: "label",
          highlight: function (element, errorClass, validClass) {
              $(element).parent().addClass("error");
              $(element).parent().removeClass("success");
          },
          unhighlight: function (element, errorClass, validClass) {
              $(element).parent().removeClass("error");
              $(element).parent().addClass("success");
          }
        });
      };
      init();  
    }
  };  
}]);

'user strict';
member.directive('accessosloMemberGrouptravel', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/member/make_request/group-travel.html',
    scope: {},
    controller: function ($scope) {
      $scope.travelData = {};

      $scope.OnSend = function () {  
        if ($("#group_form").valid()) {
          if($("#group_travel_phone").intlTelInput("isValidNumber")) {     
            $scope.travelData.travel_type="group";
            $scope.travelData.phone=$("#group_travel_phone").intlTelInput("getNumber");
            var loading = new Loading({ title: 'Please check your email.', discription: 'Loading...' });
            accessosloAPI.services.booking_travels($scope.travelData, function (response) {                                                               
              setTimeout(function () { window.location.href= response.redirect;}, 0);                    
            });
          }    
        }  else {
          alert("You must fill in all fields.");
        }       
      };

      var init = function () {
        $(".dashboard_btn").attr('style', 'display: inline-block; float:right; margin-right:10px; margin-top:8px;');
        $("#group_travel_phone").intlTelInput({
          allowDropdown: true,
          autoHideDialCode: false,
          autoPlaceholder: "polite",
          dropdownContainer: "body",
          preferredCountries: ['no', 'se', 'gb', 'de', 'us'],
          utilsScript: "/js/vendor/utils.js"
        });
        $("#group_form").validate({
          errorPlacement: function () { },
          errorClass: "label",
          highlight: function (element, errorClass, validClass) {
              $(element).parent().addClass("error");
              $(element).parent().removeClass("success");
          },
          unhighlight: function (element, errorClass, validClass) {
              $(element).parent().removeClass("error");
              $(element).parent().addClass("success");
          }
        });
      };
      init();
    }
  };  
}]);

'user strict';
member.directive('accessosloMemberHandlingrequest', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/member/make_request/handling-request.html',
    scope: {},
    controller: function ($scope) {
      $scope.handlingData = {};
      $scope.OnSend = function () {
        if($("#handling_form").valid()) {
          if($("#handling_phone").intlTelInput("isValidNumber")) {   
            $scope.handlingData.phone = $("#handling_phone").intlTelInput("getNumber");
            var loading = new Loading({ title: 'Please check your email.', discription: 'Loading...' });
            accessosloAPI.services.request($scope.handlingData, function (response) {                                                                
              setTimeout(function () { window.location.href= response.redirect;}, 0);                  
            });    
          }  
        } else {
          alert("You must fill in all fields.");
        }      
      };
      var init = function () {    
        $(".dashboard_btn").attr('style', 'display: inline-block; float:right; margin-right:10px; margin-top:8px;');
        $("#outbound_date").datepicker({
          showOtherMonths: true,selectOtherMonths: true,
          onClose: function () {
            $("#handling_form").validate().element("#outbound_date");
          }
        });
        $("#inbound_date").datepicker({
          showOtherMonths: true,selectOtherMonths: true,
          onClose: function () {
            $("#handling_form").validate().element("#inbound_date");
          }
        });
        $("#handling_phone").intlTelInput({
          allowDropdown: true,
          autoHideDialCode: false,
          autoPlaceholder: "polite",
          dropdownContainer: "body",
          preferredCountries: ['no', 'se', 'gb', 'de', 'us'],
          utilsScript: "/js/vendor/utils.js"
        });
        $("#handling_form").validate({
          errorPlacement: function () { },
          errorClass: "label",
          highlight: function (element, errorClass, validClass) {
              $(element).parent().addClass("error");
              $(element).parent().removeClass("success");
          },
          unhighlight: function (element, errorClass, validClass) {
              $(element).parent().removeClass("error");
              $(element).parent().addClass("success");
          }
        });
      };
      init();
    }
  };  
}]);

'user strict';
member.directive('accessosloMemberExecutive', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/member/make_request/executive-charter.html',
    scope: {},
    controller: function ($scope) {
      $scope.executiveflight = {}; $scope.step1 = true; $scope.step2 = false;
      $scope.passengers = []; $scope.passenger = {};
      $scope.OnContinue = function () {
        if ($("#executive1_form").valid()) {
          $scope.step1 = false; $scope.step2 = true;        
        }
      };
      $scope.OnBook = function () {
        if ($("#executive2_form").valid()) {
          if($("#executive_phone").intlTelInput("isValidNumber")) {   
            $scope.executiveflight.phone = $("#executive_phone").intlTelInput("getNumber");
            $scope.executiveflight.booking_type="executive";
            $scope.executiveflight.status="awaiting";
            var loading = new Loading({ title: 'Please check your email.', discription: 'Loading...' });      
            accessosloAPI.charters.create($scope.executiveflight, function (response) {                                                              
              setTimeout(function () { window.location.href= "/member/dashboard";}, 0);                 
            });        
          } 
        } else {
          alert("You must fill in all fields.");
        }   
      };
      var init = function () {             
        $(".dashboard_btn").attr('style', 'display: inline-block; float:right; margin-right:10px; margin-top:8px;');
        $("#executive_datepicker").datepicker({
          showOtherMonths: true,selectOtherMonths: true,
          onClose: function () {
            $("#executive1_form").validate().element("#executive_datepicker");
          }
        });
        $("#executive_phone").intlTelInput({
          allowDropdown: true,
          autoHideDialCode: false,
          autoPlaceholder: "polite",
          dropdownContainer: "body",
          preferredCountries: ['no', 'se', 'gb', 'de', 'us'],
          utilsScript: "/js/vendor/utils.js"
        });
        accessosloAPI.users.getPassengers(user, function (response) {
          $scope.passengers = response;   
          $scope.$apply();    
        });
        $("#executive1_form").validate({
          errorPlacement: function () { },
          errorClass: "label",
          highlight: function (element, errorClass, validClass) {
              $(element).parent().addClass("error");
              $(element).parent().removeClass("success");
          },
          unhighlight: function (element, errorClass, validClass) {
              $(element).parent().removeClass("error");
              $(element).parent().addClass("success");
          }
        });   
        $("#executive2_form").validate({
          errorPlacement: function () { },
          errorClass: "label",
          highlight: function (element, errorClass, validClass) {
              $(element).parent().addClass("error");
              $(element).parent().removeClass("success");
          },
          unhighlight: function (element, errorClass, validClass) {
              $(element).parent().removeClass("error");
              $(element).parent().addClass("success");
          }
        });   
      };
      init();
    }
  };  
}]);

'user strict';
member.directive('accessosloMemberGroup', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/member/make_request/group-charter.html',
    scope: {},
    controller: function ($scope) {
      $scope.groupflight = {}; $scope.step1 = true; $scope.step2 = false;
      $scope.OnContinue = function () {
        if ($("#group1_form").valid()) {
          $scope.step1 = false; $scope.step2 = true;        
        }
      };
      $scope.OnBook = function () {
        if ($("#group2_form").valid()) {
          if($("#group_phone").intlTelInput("isValidNumber")) {   
            $scope.groupflight.phone = $("#group_phone").intlTelInput("getNumber");
            $scope.groupflight.booking_type="group";
            $scope.groupflight.status="awaiting";
            var loading = new Loading({ title: 'Please check your email.', discription: 'Loading...' });
            accessosloAPI.charters.create($scope.groupflight, function (response) {                                                                  
              setTimeout(function () { window.location.href= "/member/dashboard";}, 0);               
            });           
          } 
        } else {
          alert("You must fill in all fields.");
        }   
      };
      var init = function () {         
        $(".dashboard_btn").attr('style', 'display: inline-block; float:right; margin-right:10px; margin-top:8px;');
        $("#group_datepicker").datepicker({
          showOtherMonths: true,selectOtherMonths: true,
          onClose: function () {
            $("#group1_form").validate().element("#group_datepicker");
          }
        });
        $("#group_phone").intlTelInput({
          allowDropdown: true,
          autoHideDialCode: false,
          autoPlaceholder: "polite",
          dropdownContainer: "body",
          preferredCountries: ['no', 'se', 'gb', 'de', 'us'],
          utilsScript: "/js/vendor/utils.js"
        });
        $("#group1_form").validate({
          errorPlacement: function () { },
          errorClass: "label",
          highlight: function (element, errorClass, validClass) {
              $(element).parent().addClass("error");
              $(element).parent().removeClass("success");
          },
          unhighlight: function (element, errorClass, validClass) {
              $(element).parent().removeClass("error");
              $(element).parent().addClass("success");
          }
        });   
        $("#group2_form").validate({
          errorPlacement: function () { },
          errorClass: "label",
          highlight: function (element, errorClass, validClass) {
              $(element).parent().addClass("error");
              $(element).parent().removeClass("success");
          },
          unhighlight: function (element, errorClass, validClass) {
              $(element).parent().removeClass("error");
              $(element).parent().addClass("success");
          }
        });   
      };

      init();
    }
  };  
}]);

'user strict';
member.directive('accessosloMemberHelicopter', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/member/make_request/helicopter-charter.html',
    scope: {},
    controller: function ($scope) {
      $scope.helicopterflight = {}; $scope.step1 = true; $scope.step2 = false;
      $scope.OnContinue = function () {
        if($("#helicopter1_form").valid()) {
          $scope.step1 = false; $scope.step2 =  true;        
        }
      };
      $scope.OnBook = function () {
        if($("#helicopter2_form").valid()) {
          if($("#helicopter_phone").intlTelInput("isValidNumber")) {   
            $scope.helicopterflight.phone = $("#helicopter_phone").intlTelInput("getNumber");
            $scope.helicopterflight.booking_type="helicopter";
            $scope.helicopterflight.status="awaiting";
            var loading = new Loading({ title: 'Please check your email.', discription: 'Loading...' });
            accessosloAPI.charters.create($scope.helicopterflight, function (response) {                                                                 
              setTimeout(function () { window.location.href= "/member/dashboard";}, 0);                
            });     
          }      
        } else {
          alert("You must fill in all fields.");
        }    
      };
      var init = function () {     
        $(".dashboard_btn").attr('style', 'display: inline-block; float:right; margin-right:10px; margin-top:8px;');
        $("#helicopter_datepicker").datepicker({
          showOtherMonths: true,selectOtherMonths: true,
          onClose: function () {
            $("#helicopter1_form").validate().element("#helicopter_datepicker");
          }
        });
        $("#helicopter_phone").intlTelInput({
          allowDropdown: true,
          autoHideDialCode: false,
          autoPlaceholder: "polite",
          dropdownContainer: "body",
          preferredCountries: ['no', 'se', 'gb', 'de', 'us'],
          utilsScript: "/js/vendor/utils.js"
        });
        $("#helicopter1_form").validate({
          errorPlacement: function () { },
          errorClass: "label",
          highlight: function (element, errorClass, validClass) {
              $(element).parent().addClass("error");
              $(element).parent().removeClass("success");
          },
          unhighlight: function (element, errorClass, validClass) {
              $(element).parent().removeClass("error");
              $(element).parent().addClass("success");
          }
        });   
        $("#helicopter2_form").validate({
          errorPlacement: function () { },
          errorClass: "label",
          highlight: function (element, errorClass, validClass) {
              $(element).parent().addClass("error");
              $(element).parent().removeClass("success");
          },
          unhighlight: function (element, errorClass, validClass) {
              $(element).parent().removeClass("error");
              $(element).parent().addClass("success");
          }
        });   
      };
      init();
    }
  };  
}]);

'user strict';
member.directive('accessosloMemberCargo', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/member/make_request/cargo-charter.html',
    scope: {},
    controller: function ($scope) {
      $scope.cargoflight = {}; $scope.step1 = true; $scope.step2 = false;
      $scope.OnContinue = function () {
        if($("#cargo1_form").valid()) {
          $scope.step1 = false; $scope.step2 = true;        
        }
      };
      $scope.OnBook = function () {
        if($("#cargo2_form").valid()) {
          if($("#cargo_phone").intlTelInput("isValidNumber")) {   
            $scope.cargoflight.phone = $("#cargo_phone").intlTelInput("getNumber");
            $scope.cargoflight.status="awaiting";
            var loading = new Loading({ title: 'Please check your email.', discription: 'Loading...' });
            accessosloAPI.charters.cargo_booking($scope.cargoflight, function (response) {                                                             
              setTimeout(function () { window.location.href= "/member/dashboard";}, 0);               
            });     
          }   
        } else {
          alert("You must fill in all fields.");
        }      
      };
      var init = function () {     
        $(".dashboard_btn").attr('style', 'display: inline-block; float:right; margin-right:10px; margin-top:8px;');
        $("#cargo_datepicker").datepicker({
          showOtherMonths: true,selectOtherMonths: true,
          onClose: function () {
            $("#cargo1_form").validate().element("#cargo_datepicker");
          }
        });
        $("#cargo_phone").intlTelInput({
          allowDropdown: true,
          autoHideDialCode: false,
          autoPlaceholder: "polite",
          dropdownContainer: "body",
          preferredCountries: ['no', 'se', 'gb', 'de', 'us'],
          utilsScript: "/js/vendor/utils.js"
        });
        $("#cargo1_form").validate({
          errorPlacement: function () { },
          errorClass: "label",
          highlight: function (element, errorClass, validClass) {
              $(element).parent().addClass("error");
              $(element).parent().removeClass("success");
          },
          unhighlight: function (element, errorClass, validClass) {
              $(element).parent().removeClass("error");
              $(element).parent().addClass("success");
          }
        });   
        $("#cargo2_form").validate({
          errorPlacement: function () { },
          errorClass: "label",
          highlight: function (element, errorClass, validClass) {
              $(element).parent().addClass("error");
              $(element).parent().removeClass("success");
          },
          unhighlight: function (element, errorClass, validClass) {
              $(element).parent().removeClass("error");
              $(element).parent().addClass("success");
          }
        });  
      };      
      init();
    }
  };  
}]);

'user strict';
member.directive('accessosloPassenger', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/member/passengers/view.html',
    scope: {},
    controller: function ($scope) {
      $scope.passengers = [];
      $scope.passenger = {};
      $scope.OnDelete = function (passenger) {
        alert("Are you sure?");
        var loading = new Loading({ title: 'Please check your email.', discription: 'Loading...' });
        accessosloAPI.users.deletePassenger(passenger, function (response) {          
          init();    
        });   
      };
      var init = function () {    
        $(".dashboard_btn").attr('style', 'display: inline-block; float:right; margin-right:10px; margin-top:8px;');
        accessosloAPI.users.getPassengers(user, function (response) {
          $scope.passengers = response;     
          $scope.$apply();    
        });   
      };
      init();
    }
  };  
}]);

'user strict';
member.directive('accessosloMemberProfile', ["accessosloAPI", function (accessosloAPI) {
  return {
    templateUrl: '/ng/modules/member/profile_settings/view.html',
    scope: {},
    controller: function ($scope) {
      var is_new = true;
      $scope.profile_data = {};
      var SaveProfile = function (e) {
        e.preventDefault();
       
        if ($("#input_form").valid()) {
          if ($("#home-number").intlTelInput('isValidNumber') && $("#mobile-number").intlTelInput('isValidNumber') && $("#business-number").intlTelInput('isValidNumber')) {
            $scope.profile_data.user_id = user.id;
            $scope.profile_data.home_phone = $("#home-number").intlTelInput("getNumber");
            $scope.profile_data.mobile_phone = $("#mobile-number").intlTelInput("getNumber");
            $scope.profile_data.business_phone = $("#business-number").intlTelInput("getNumber");
            var selected_country = $("#country_address").countrySelect("getSelectedCountryData");
            $scope.profile_data.addInfo_country = selected_country.name;
            if (is_new) { 
              var loading = new Loading({ discription: 'Loading...' });
              accessosloAPI.users.add_profile($scope.profile_data, function (response) {
                alert("Your settings have been saved.");
                setTimeout(function () { window.location.href= "/member/dashboard";}, 0);      
              });
            } else {
              var loading = new Loading({ discription: 'Loading...' });
              accessosloAPI.users.update_profile($scope.profile_data, function (response) {
                alert("Your settings have been saved.");
                setTimeout(function () { window.location.href= "/member/dashboard";}, 0);
              });
            }
          } else {
            alert("Invalid Phone number!");
          }
        }
      };
      $scope.percentage = function (){
        let width = 0;
          
        if($("#gender").val() != "") { width += 6.25; } 
        if($("#first_name").val() != ""){ width += 6.25; } 
        if($("#last_name").val() != ""){ width += 6.25; } 
        if($("#email").val() != ""){ width += 6.25; } 
        if($("#datepicker").val() != "" && $("#datepicker").val() != undefined){ width += 6.25; }
        if($("#company").val() != ""){ width += 6.25; }
        if($("#job").val() != ""){ width += 6.25; }
        if($("#home-number").intlTelInput('isValidNumber')){ width += 6.25; } 
        if($("#mobile-number").intlTelInput('isValidNumber')){ width += 6.25; }
        if($("#business-number").intlTelInput('isValidNumber')){ width += 6.25; }
        if($("#mobile_type").val() != "" && $("#mobile_type").val() != null){ width += 6.25; }
        if($("#addInfo_address1").val() != ""){ width += 6.25; }
        if($("#addInfo_city").val() != ""){ width += 6.25; }
        if($("#addInfo_region").val() != ""){ width += 6.25; }
        if($("#addInfo_code").val() != ""){ width += 6.25; }
        if($("#country_address").val() != ""){ width += 6.25; }
        return width;
      };
      var init = function () {
        $(".dashboard_btn").attr('style', 'display: inline-block; float:right; margin-right:10px; margin-top:8px; float:right; margin-right:10px; margin-top:8px;');
        $("#input_form").validate({
          errorPlacement: function () {},
          errorClass: "label",
          highlight: function (element, errorClass, validClass) {
            $(element).parent().addClass("error");
            $(element).parent().removeClass("success");
          },
          unhighlight: function (element, errorClass, validClass) {
            $(element).parent().removeClass("error");
            $(element).parent().addClass("success");
          }
        });
        $("#home-number").intlTelInput({
          allowDropdown: true,
          autoHideDialCode: false,
          autoPlaceholder: "polite",
          dropdownContainer: "body",
          preferredCountries: ['no', 'se', 'gb', 'de', 'us'],
          utilsScript: "/js/vendor/utils.js"
        });
        $("#mobile-number").intlTelInput({
          allowDropdown: true,
          autoHideDialCode: false,
          autoPlaceholder: "polite",
          dropdownContainer: "body",
          preferredCountries: ['no', 'se', 'gb', 'de', 'us'],
          utilsScript: "/js/vendor/utils.js"
        });
        $("#business-number").intlTelInput({
          allowDropdown: true,
          autoHideDialCode: false,
          autoPlaceholder: "polite",
          dropdownContainer: "body",
          preferredCountries: ['no', 'se', 'gb', 'de', 'us'],
          utilsScript: "/js/vendor/utils.js"
        });
        $("#country_address").countrySelect({
          preferredCountries: ['no', 'se', 'gb', 'de', 'us']
        });
        $("#country_billing").countrySelect({
          preferredCountries: ['no', 'se', 'gb', 'de', 'us']
        });
        $("#datepicker").datepicker({
          showOtherMonths: true,
          selectOtherMonths: true,
          onClose: function () {
            $('#input_form').validate().element("#datepicker");
          }
        });
        $("#save").click(SaveProfile);
        var data = {
          id: user.id,
          destination: "get",
          email: user.email
        };             
        accessosloAPI.users.getCustomer(data, function (response) {             
          if (response) {
            $scope.profile_data = response;
            $("#home-number").intlTelInput("setNumber", response.home_phone);
            $("#mobile-number").intlTelInput("setNumber", response.mobile_phone);
            $("#business-number").intlTelInput("setNumber", response.business_phone);
            $("#country_address").countrySelect("setCountry", response.addInfo_country);
            is_new = false;
            $scope.$apply();
          } else {            
            is_new = true;            
            $scope.profile_data.gender = user.gender;
            $scope.profile_data.first_name = user.first_name;
            $scope.profile_data.last_name = user.last_name;
            $scope.profile_data.email = user.email;   
            $scope.$apply();       
            $("#home-number").intlTelInput("setNumber", user.phone); 
            $("#gender").focus();     
            $("#email").focus();      
            $("#first_name").focus();     
            $("#last_name").focus();  
            $("#home-number").focus();   
          }
        });
        accessosloAPI.charters.getMemberNotice(data, function (response) {             
            $(".member_notice").attr("style", "display:inline;");
            $(".member_notice").html(response);        
        });     
      };
      init();
    }
  };
}]);
